<div class="dialog-backdrop">
  <div class="dialog-box" [ngClass]="{ 'success-mode': success }">

    <!-- TOAST -->
    <app-toast [message]="alertMessage" [show]="showAlert"></app-toast>

    <!-- MODO SUCESSO -->
    <ng-container *ngIf="success; else formMode">
      <div class="success-container">
        <div class="success-check">✔</div>
        <h2>Cargo atualizado!</h2>

        <p class="success-line"><strong>Usuário:</strong> {{ responseData?.username }}</p>
        <p class="success-line"><strong>CPF:</strong> {{ responseData?.cpf }}</p>
        <p class="success-line"><strong>Novo Cargo:</strong> {{ responseData?.novoCargo }}</p>

        <p class="success-msg">{{ responseData?.mensagem }}</p>
      </div>
    </ng-container>

    <!-- MODO FORMULÁRIO -->
    <ng-template #formMode>
      <h2>Alterar Cargo</h2>

      <label>Username</label>
      <input type="text" [(ngModel)]="username" [ngClass]="{'invalid': invalid.username}" />

      <label>CPF</label>
      <input type="text" [(ngModel)]="cpf" [ngClass]="{'invalid': invalid.cpf}" />

      <label>Nova Função</label>
      <select [(ngModel)]="role" [ngClass]="{'invalid': invalid.role}">
        <option value="ADMIN">Administrador</option>
        <option value="FUNCIONARIO">Funcionário</option>
        <option value="USUARIO">Usuário</option>
      </select>

      <div class="actions">
        <button class="cancel" (click)="close.emit()">Cancelar</button>

        <button class="confirm" (click)="submit()" [disabled]="loading">
          {{ loading ? "Enviando..." : "Confirmar" }}
        </button>
      </div>
    </ng-template>

  </div>
</div>
