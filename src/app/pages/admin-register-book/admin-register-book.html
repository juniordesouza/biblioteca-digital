<app-admin-header (toggleSidebar)="toggleSidebar()"></app-admin-header>
<app-sidebar [isOpen]="sidebarOpen"></app-sidebar>

<!-- TOAST -->
<app-toast [message]="alertMessage" [show]="showAlert"></app-toast>

<!-- Modern Toast extra (como no login) -->
<div class="modern-toast" *ngIf="showAlert">
  <div class="toast-content">
    <span class="toast-icon">⚠️</span>
    <span>{{ alertMessage }}</span>
  </div>
</div>

<div class="main-layout" [class.sidebar-open]="sidebarOpen">
  <main class="content">

    <form class="book-wrapper" (ngSubmit)="salvarLivro()" enctype="multipart/form-data">

      <!-- ===================== ESQUERDA ===================== -->
      <div class="left-panel">

        <label class="section-title">FOTO CAPA</label>

        <div class="cover-box">
          <img 
            *ngIf="previewCapa"
            [src]="previewCapa"
            class="cover-preview"
          />

          <div class="cover-placeholder" *ngIf="!previewCapa">
            <span>ANEXAR FOTO</span>
            <span class="material-icons">image</span>
          </div>
        </div>

        <label class="upload-box">
          <span class="material-icons">attach_file</span>
          <span>Anexar Capa</span>
          <input type="file" accept="image/*" (change)="onCapaSelected($event)" hidden />
        </label>

        <label class="section-title small">ANEXAR LIVRO (PDF)</label>

        <label class="upload-box">
          <span class="material-icons">attach_file</span>
          <span>Anexar PDF</span>
          <input type="file" accept="application/pdf" (change)="onPdfSelected($event)" hidden />
        </label>

      </div>

      <!-- ===================== DIREITA ===================== -->
      <div class="right-panel">

        <div class="input-row">
          <div class="form-group">
            <label>NOME LIVRO</label>
            <input type="text" [(ngModel)]="livro.txt_titulo" name="titulo" required />
          </div>

          <div class="form-group">
            <label>NOME AUTOR</label>
            <input type="text" [(ngModel)]="livro.autor" name="autor" placeholder="(caso exista na obra)" />
          </div>
        </div>

        <div class="input-row">
          <div class="form-group">
            <label>EDITORA</label>
            <select [(ngModel)]="livro.editora" name="editora">
              <option [value]="null">Selecione...</option>
              <option *ngFor="let e of editoras" [value]="e.nome">
                {{ e.nome }}
              </option>
            </select>
          </div>

          <div class="form-group">
            <label>TEMA</label>
            <input type="text" [(ngModel)]="livro.tema" name="tema" placeholder="Tema" />
          </div>
        </div>

        <div class="input-row">
          <div class="form-group">
            <label>DATA LANÇAMENTO</label>
            <input 
              type="text"
              maxlength="10"
              placeholder="dd/mm/aaaa"
              [(ngModel)]="livro.ano_lancamento"
              name="ano"
            />
          </div>

          <div class="form-group">
            <label>QUANTIDADE DISPONÍVEL</label>
            <input 
              type="number"
              min="1"
              [(ngModel)]="livro.quantidade_disponivel"
              name="quantidade_disponivel"
              required
            />
          </div>
        </div>

        <div class="form-group wide">
          <label>SINOPSE</label>
          <textarea rows="6" [(ngModel)]="livro.txt_sinopse" name="sinopse"></textarea>
        </div>

        <div class="button-area">
          <button class="btn-submit" type="submit">CADASTRAR</button>
        </div>

      </div>

    </form>

  </main>
</div>
