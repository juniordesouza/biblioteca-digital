<app-admin-header (toggleSidebar)="toggleSidebar()"></app-admin-header>
<app-sidebar [isOpen]="sidebarOpen"></app-sidebar>

<div class="main-layout" [class.sidebar-open]="sidebarOpen">
  <main class="content">

    <h2>Lista de UsuÃ¡rios</h2>

    <!-- ðŸ”¥ EMPTY STATE -->
    <div class="empty-box" *ngIf="usuarios.length === 0">
      <p>Nenhum usuÃ¡rio encontrado.</p>
    </div>

    <!-- ðŸ”¥ AÃ‡Ã•ES SUPERIORES -->
    <div class="bulk-actions" *ngIf="usuarios.length > 0">

      <button class="btn-block" (click)="banirSelecionados()">
        Bloquear Selecionados
      </button>

      <button class="btn-unblock" (click)="desbanirSelecionados()">
        Desbloquear Selecionados
      </button>

    </div>

    <!-- ðŸ”¥ TABELA COMPLETA -->
    <div class="table-container" *ngIf="usuarios.length > 0">

      <table>
        <thead>
          <tr>
            <th><input type="checkbox" [checked]="allSelected" (change)="toggleSelectAll($event)" /></th>

            <th>Username</th>
            <th>Status</th>
            <th>Nome</th>
            <th>Email</th>
            <th>CPF</th>
            <th>Data Nasc.</th>
            <th>Telefone</th>
            <th>EndereÃ§o</th>
            <th>CEP</th>
            <th>Cadastro</th>
            <th>Sexo</th>
            <th>Role</th>
            <th>Doc.</th>
            <th>DesativaÃ§Ã£o</th>
            <th>Banimento</th>
            <th>Slots</th>
            <th>Capa</th>

            <th>AÃ§Ãµes</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let user of usuarios">
            <td>
              <input type="checkbox" [(ngModel)]="user.selected" (change)="updateSelectAllState()" />
            </td>

            <td>{{ user.username }}</td>

            <td>
              <span [ngStyle]="{
                color:
                  user.status === 'ATIVO' ? 'green' :
                  user.status === 'PENDENTE' ? 'goldenrod' :
                  'red'
              }">
                {{ user.status }}
              </span>
            </td>

            <td>{{ user.fullName }}</td>
            <td>{{ user.email }}</td>
            <td>{{ user.cpf }}</td>
            <td>{{ user.birthDate }}</td>
            <td>{{ user.telefone }}</td>
            <td>{{ user.endereco }}</td>
            <td>{{ user.cep }}</td>
            <td>{{ user.dtCadastro | date:'dd/MM/yyyy HH:mm' }}</td>
            <td>{{ user.sexo }}</td>
            <td>{{ user.role }}</td>
            <td>{{ user.urlDocumento || '-' }}</td>
            <td>{{ user.dtDesativacao || '-' }}</td>
            <td>{{ user.dtBanimento || '-' }}</td>
            <td>{{ user.limiteSlots }}</td>
            <td>{{ user.urlCapa || '-' }}</td>
            <div class="actions-wrap">
                <td class="actions">
                <button class="btn-ban" (click)="banirUsuario(user.username)">ðŸš«</button>
                <button class="btn-unban" (click)="desbanirUsuario(user.username)">ðŸ”“</button>
                </td>
            </div>
          </tr>
        </tbody>
      </table>

    </div>

    <!-- ðŸ”¥ TOAST -->
    <app-toast [message]="alertMessage" [show]="showAlert"></app-toast>

  </main>
</div>
